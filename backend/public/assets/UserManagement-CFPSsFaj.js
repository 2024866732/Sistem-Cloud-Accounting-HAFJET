import{r as e}from"./rolldown-runtime-DGruFWvd.js";import{_ as t}from"./charts-CsPrSeQA.js";import{B as n,E as r,M as i,V as a,W as o,a as s,b as c,c as l,f as u,ft as d,g as f,j as p,mt as m,o as h,s as g,v as _,w as v}from"./vendor-cVok5HuT.js";import{i as y,r as b}from"./index-DgESSmYL.js";var x=e(t()),S=e(m()),C=({open:e,onClose:t,qrDataUrl:n,secret:r,backupCodes:i})=>e?(0,S.jsx)(`div`,{className:`fixed inset-0 z-50 flex items-center justify-center bg-black/50`,children:(0,S.jsxs)(`div`,{className:`bg-white dark:bg-gray-900 rounded-2xl p-6 w-full max-w-lg`,children:[(0,S.jsxs)(`div`,{className:`flex justify-between items-center mb-4`,children:[(0,S.jsx)(`h3`,{className:`text-lg font-semibold text-gray-900 dark:text-white`,children:`Two-Factor Authentication`}),(0,S.jsx)(`button`,{onClick:t,className:`text-gray-500`,children:`✕`})]}),(0,S.jsxs)(`div`,{className:`space-y-4 text-gray-800 dark:text-gray-200`,children:[n?(0,S.jsxs)(`div`,{className:`flex items-center space-x-4`,children:[(0,S.jsx)(`img`,{src:n,alt:`2FA QR`,className:`w-32 h-32 bg-white p-2 rounded-md`}),(0,S.jsxs)(`div`,{children:[(0,S.jsx)(`p`,{className:`text-sm`,children:`Scan this QR with your authenticator app.`}),r&&(0,S.jsxs)(`div`,{className:`mt-2 text-sm`,children:[(0,S.jsx)(`div`,{className:`font-mono bg-gray-100 dark:bg-gray-800 px-3 py-1 rounded-md inline-block`,children:r}),(0,S.jsx)(`button`,{onClick:()=>{navigator.clipboard?.writeText(r)},className:`ml-2 text-xs text-blue-600`,children:`Copy`})]})]})]}):null,i&&i.length>0&&(0,S.jsxs)(`div`,{children:[(0,S.jsx)(`h4`,{className:`font-medium`,children:`Backup codes`}),(0,S.jsx)(`p`,{className:`text-sm mb-2`,children:`Store these in a safe place. Each code can be used once.`}),(0,S.jsx)(`div`,{className:`grid grid-cols-2 gap-2`,children:i.map((e,t)=>(0,S.jsxs)(`div`,{className:`p-2 bg-gray-100 dark:bg-gray-800 rounded-md font-mono text-sm flex justify-between items-center`,children:[(0,S.jsx)(`span`,{children:e}),(0,S.jsx)(`button`,{onClick:()=>navigator.clipboard?.writeText(e),className:`text-xs text-blue-600 ml-2`,children:`Copy`})]},t))})]}),(0,S.jsx)(`div`,{className:`text-right`,children:(0,S.jsx)(`button`,{onClick:t,className:`px-4 py-2 bg-blue-600 text-white rounded-lg`,children:`Close`})})]})]})}):null,w=()=>{let[e,t]=(0,x.useState)([]),[m,w]=(0,x.useState)([]),[T,E]=(0,x.useState)([]),[D,O]=(0,x.useState)(`users`),[k,A]=(0,x.useState)(``),[j,M]=(0,x.useState)(`all`),[N,P]=(0,x.useState)(`all`),[F,I]=(0,x.useState)(!0),[L,R]=(0,x.useState)(null),[z,B]=(0,x.useState)(!1),[V,H]=(0,x.useState)(null),[U,W]=(0,x.useState)(void 0);(0,x.useEffect)(()=>{(async()=>{I(!0),await new Promise(e=>setTimeout(e,1e3)),w([{id:`1`,name:`Super Admin`,description:`Full system access and control`,permissions:[`all`],color:`from-red-500 to-red-600`},{id:`2`,name:`Admin`,description:`Administrative access to all modules`,permissions:[`users.manage`,`settings.manage`,`reports.view`,`transactions.manage`],color:`from-purple-500 to-purple-600`},{id:`3`,name:`Manager`,description:`Management level access`,permissions:[`reports.view`,`transactions.view`,`invoices.manage`,`analytics.view`],color:`from-blue-500 to-blue-600`},{id:`4`,name:`Accountant`,description:`Accounting and financial operations`,permissions:[`transactions.manage`,`invoices.manage`,`reports.view`],color:`from-green-500 to-green-600`},{id:`5`,name:`Staff`,description:`Basic operational access`,permissions:[`transactions.create`,`invoices.create`],color:`from-yellow-500 to-yellow-600`},{id:`6`,name:`Viewer`,description:`Read-only access`,permissions:[`reports.view`,`transactions.view`],color:`from-gray-500 to-gray-600`}]),t([{id:`1`,name:`Ahmad Rahman`,email:`ahmad.rahman@hafjet.com`,phone:`+601234567890`,role:`super_admin`,permissions:[`all`],status:`active`,lastLogin:new Date(Date.now()-1800*1e3),createdAt:new Date(Date.now()-365*24*60*60*1e3),department:`IT Administration`,twoFactorEnabled:!0},{id:`2`,name:`Siti Nurhaliza`,email:`siti.nurhaliza@hafjet.com`,phone:`+601234567891`,role:`admin`,permissions:[`users.manage`,`settings.manage`,`reports.view`],status:`active`,lastLogin:new Date(Date.now()-7200*1e3),createdAt:new Date(Date.now()-4800*60*60*1e3),department:`Administration`,twoFactorEnabled:!0},{id:`3`,name:`Lim Wei Ming`,email:`lim.weiming@hafjet.com`,phone:`+601234567892`,role:`manager`,permissions:[`reports.view`,`transactions.view`,`invoices.manage`],status:`active`,lastLogin:new Date(Date.now()-14400*1e3),createdAt:new Date(Date.now()-3600*60*60*1e3),department:`Finance`,twoFactorEnabled:!1},{id:`4`,name:`Kavitha Ramasamy`,email:`kavitha.ramasamy@hafjet.com`,phone:`+601234567893`,role:`accountant`,permissions:[`transactions.manage`,`invoices.manage`,`reports.view`],status:`active`,lastLogin:new Date(Date.now()-360*60*1e3),createdAt:new Date(Date.now()-2400*60*60*1e3),department:`Accounting`,twoFactorEnabled:!0},{id:`5`,name:`David Tan`,email:`david.tan@hafjet.com`,phone:`+601234567894`,role:`staff`,permissions:[`transactions.create`,`invoices.create`],status:`inactive`,lastLogin:new Date(Date.now()-720*60*60*1e3),createdAt:new Date(Date.now()-1440*60*60*1e3),department:`Operations`,twoFactorEnabled:!1}]),E([{id:`1`,userId:`1`,userName:`Ahmad Rahman`,action:`User Login`,resource:`Authentication`,timestamp:new Date(Date.now()-1800*1e3),ipAddress:`192.168.1.100`,userAgent:`Mozilla/5.0 Chrome/118.0`},{id:`2`,userId:`2`,userName:`Siti Nurhaliza`,action:`Created Invoice`,resource:`INV-2025-001`,timestamp:new Date(Date.now()-7200*1e3),ipAddress:`192.168.1.101`,userAgent:`Mozilla/5.0 Chrome/118.0`},{id:`3`,userId:`3`,userName:`Lim Wei Ming`,action:`Generated Report`,resource:`Profit & Loss Report`,timestamp:new Date(Date.now()-14400*1e3),ipAddress:`192.168.1.102`,userAgent:`Mozilla/5.0 Safari/605.1`}]);try{let e=await b.getCurrentUser();R(e?.data||null)}catch{R(null)}I(!1)})()},[]);let G=e=>{let t=new Date,n=Math.floor((t.getTime()-e.getTime())/(1e3*60));return n<60?`${n} minutes ago`:n<1440?`${Math.floor(n/60)} hours ago`:`${Math.floor(n/1440)} days ago`},K=e=>m.find(t=>t.name.toLowerCase().replace(` `,`_`)===e)?.color||`from-gray-500 to-gray-600`,q=e=>{switch(e){case`active`:return`text-green-400 bg-green-500/10`;case`inactive`:return`text-gray-400 bg-gray-500/10`;case`suspended`:return`text-red-400 bg-red-500/10`;default:return`text-blue-400 bg-blue-500/10`}},J=e.filter(e=>{let t=e.name.toLowerCase().includes(k.toLowerCase())||e.email.toLowerCase().includes(k.toLowerCase()),n=j===`all`||e.role===j,r=N===`all`||e.status===N;return t&&n&&r}),Y=e=>{t(t=>t.map(t=>t.id===e?{...t,status:t.status===`active`?`inactive`:`active`}:t))},X=e=>{t(t=>t.map(t=>t.id===e?{...t,twoFactorEnabled:!t.twoFactorEnabled}:t))};return(0,S.jsx)(`div`,{className:`min-h-screen bg-gradient-to-br from-blue-900 to-purple-900 p-6`,children:(0,S.jsxs)(`div`,{className:`max-w-7xl mx-auto`,children:[(0,S.jsxs)(`div`,{className:`mb-8`,children:[(0,S.jsx)(`h1`,{className:`text-4xl font-bold text-white mb-2`,children:`👥 User Management`}),(0,S.jsx)(`p`,{className:`text-white/80 text-lg`,children:`🔐 Comprehensive user management with role-based permissions and audit trails`})]}),(0,S.jsx)(`div`,{className:`bg-white/20 backdrop-blur-sm rounded-2xl p-6 border border-white/30 mb-8`,children:(0,S.jsx)(`div`,{className:`flex space-x-2`,children:[{id:`users`,label:`Users`,icon:s,count:e.length},{id:`roles`,label:`Roles & Permissions`,icon:f,count:m.length},{id:`audit`,label:`Audit Logs`,icon:d,count:T.length},{id:`settings`,label:`Security Settings`,icon:_,count:0}].map(e=>{let t=e.icon;return(0,S.jsxs)(`button`,{onClick:()=>O(e.id),className:`flex items-center space-x-2 px-4 py-3 rounded-xl transition-all duration-300 ${D===e.id?`bg-white/30 text-white font-semibold shadow-lg`:`text-white/70 hover:bg-white/20`}`,children:[(0,S.jsx)(t,{className:`h-5 w-5`}),(0,S.jsx)(`span`,{children:e.label}),e.count>0&&(0,S.jsx)(`span`,{className:`bg-blue-500 text-white text-xs px-2 py-1 rounded-full`,children:e.count})]},e.id)})})}),(0,S.jsx)(`div`,{className:`mb-8`,children:F?(0,S.jsx)(`div`,{className:`flex items-center justify-center h-64`,children:(0,S.jsx)(`div`,{className:`animate-spin h-12 w-12 border-4 border-white/30 border-t-white rounded-full`})}):(0,S.jsxs)(S.Fragment,{children:[D===`users`&&(()=>(0,S.jsxs)(`div`,{className:`space-y-6`,children:[(0,S.jsx)(`div`,{className:`bg-white/20 backdrop-blur-sm rounded-2xl p-6 border border-white/30`,children:(0,S.jsxs)(`div`,{className:`flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0`,children:[(0,S.jsxs)(`div`,{className:`flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4`,children:[(0,S.jsxs)(`div`,{className:`relative`,children:[(0,S.jsx)(c,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 text-white/60 h-4 w-4`}),(0,S.jsx)(`input`,{type:`text`,placeholder:`Search users...`,value:k,onChange:e=>A(e.target.value),className:`pl-10 pr-4 py-2 bg-white/10 border border-white/30 rounded-xl text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-blue-500`})]}),(0,S.jsxs)(`select`,{value:j,onChange:e=>M(e.target.value),className:`bg-white/10 border border-white/30 rounded-xl px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-500`,children:[(0,S.jsx)(`option`,{value:`all`,className:`bg-gray-800`,children:`All Roles`}),m.map(e=>(0,S.jsx)(`option`,{value:e.name.toLowerCase().replace(` `,`_`),className:`bg-gray-800`,children:e.name},e.id))]}),(0,S.jsxs)(`select`,{value:N,onChange:e=>P(e.target.value),className:`bg-white/10 border border-white/30 rounded-xl px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-500`,children:[(0,S.jsx)(`option`,{value:`all`,className:`bg-gray-800`,children:`All Status`}),(0,S.jsx)(`option`,{value:`active`,className:`bg-gray-800`,children:`Active`}),(0,S.jsx)(`option`,{value:`inactive`,className:`bg-gray-800`,children:`Inactive`}),(0,S.jsx)(`option`,{value:`suspended`,className:`bg-gray-800`,children:`Suspended`})]})]}),(0,S.jsxs)(`div`,{className:`flex space-x-3`,children:[(0,S.jsxs)(`button`,{className:`bg-blue-600 text-white px-4 py-2 rounded-xl font-medium hover:bg-blue-700 transition-colors`,children:[(0,S.jsx)(l,{className:`inline h-4 w-4 mr-2`}),`Import`]}),(0,S.jsxs)(`button`,{className:`bg-green-600 text-white px-4 py-2 rounded-xl font-medium hover:bg-green-700 transition-colors`,children:[(0,S.jsx)(a,{className:`inline h-4 w-4 mr-2`}),`Export`]}),(0,S.jsxs)(`button`,{className:`bg-gradient-to-r from-purple-600 to-blue-600 text-white px-4 py-2 rounded-xl font-medium hover:shadow-lg transition-all duration-300`,children:[(0,S.jsx)(v,{className:`inline h-4 w-4 mr-2`}),`Add User`]})]})]})}),(0,S.jsx)(`div`,{className:`grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6`,children:J.map(e=>(0,S.jsxs)(`div`,{className:`bg-white/20 backdrop-blur-sm rounded-2xl p-6 border border-white/30 hover:shadow-lg transition-all duration-300`,children:[(0,S.jsxs)(`div`,{className:`flex items-start justify-between mb-4`,children:[(0,S.jsxs)(`div`,{className:`flex items-center space-x-3`,children:[(0,S.jsx)(`div`,{className:`h-12 w-12 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-lg`,children:e.name.charAt(0)}),(0,S.jsxs)(`div`,{children:[(0,S.jsx)(`h3`,{className:`text-white font-semibold`,children:e.name}),(0,S.jsx)(`p`,{className:`text-white/60 text-sm`,children:e.email})]})]}),(0,S.jsxs)(`div`,{className:`flex space-x-2`,children:[(0,S.jsx)(`button`,{className:`p-2 text-white/60 hover:text-blue-400 hover:bg-blue-500/10 rounded-xl transition-colors`,children:(0,S.jsx)(r,{className:`h-4 w-4`})}),(0,S.jsx)(`button`,{className:`p-2 text-white/60 hover:text-red-400 hover:bg-red-500/10 rounded-xl transition-colors`,children:(0,S.jsx)(u,{className:`h-4 w-4`})})]})]}),(0,S.jsxs)(`div`,{className:`space-y-3 mb-4`,children:[(0,S.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,S.jsx)(`span`,{className:`text-white/80 text-sm`,children:`Role`}),(0,S.jsx)(`span`,{className:`px-3 py-1 rounded-full text-xs font-medium text-white bg-gradient-to-r ${K(e.role)}`,children:e.role.replace(`_`,` `).replace(/\b\w/g,e=>e.toUpperCase())})]}),(0,S.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,S.jsx)(`span`,{className:`text-white/80 text-sm`,children:`Status`}),(0,S.jsx)(`span`,{className:`px-3 py-1 rounded-full text-xs font-medium ${q(e.status)}`,children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})]}),(0,S.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,S.jsx)(`span`,{className:`text-white/80 text-sm`,children:`2FA`}),(0,S.jsxs)(`div`,{className:`flex items-center space-x-2`,children:[e.twoFactorEnabled?(0,S.jsx)(f,{className:`h-4 w-4 text-green-400`}):(0,S.jsx)(i,{className:`h-4 w-4 text-red-400`}),(0,S.jsx)(`button`,{onClick:()=>X(e.id),className:`text-blue-400 hover:text-blue-300 text-xs`,children:e.twoFactorEnabled?`Disable`:`Enable`})]})]}),e.lastLogin&&(0,S.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,S.jsx)(`span`,{className:`text-white/80 text-sm`,children:`Last Login`}),(0,S.jsx)(`span`,{className:`text-white/60 text-xs`,children:G(e.lastLogin)})]})]}),(0,S.jsxs)(`div`,{className:`flex space-x-3`,children:[(0,S.jsx)(`button`,{onClick:()=>Y(e.id),className:`flex-1 py-2 px-4 rounded-xl text-sm font-medium transition-colors ${e.status===`active`?`bg-red-600 text-white hover:bg-red-700`:`bg-green-600 text-white hover:bg-green-700`}`,children:e.status===`active`?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(h,{className:`inline h-4 w-4 mr-2`}),`Deactivate`]}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(g,{className:`inline h-4 w-4 mr-2`}),`Activate`]})}),(0,S.jsxs)(`button`,{className:`py-2 px-4 bg-blue-600 text-white rounded-xl text-sm font-medium hover:bg-blue-700 transition-colors`,children:[(0,S.jsx)(p,{className:`inline h-4 w-4 mr-2`}),`Email`]})]})]},e.id))}),J.length===0&&(0,S.jsxs)(`div`,{className:`text-center py-12`,children:[(0,S.jsx)(s,{className:`h-16 w-16 text-white/40 mx-auto mb-4`}),(0,S.jsx)(`h3`,{className:`text-xl font-semibold text-white/80 mb-2`,children:`No users found`}),(0,S.jsx)(`p`,{className:`text-white/60`,children:`Try adjusting your search criteria.`})]})]}))(),D===`roles`&&(()=>(0,S.jsx)(`div`,{className:`space-y-6`,children:(0,S.jsxs)(`div`,{className:`bg-white/20 backdrop-blur-sm rounded-2xl p-6 border border-white/30`,children:[(0,S.jsxs)(`div`,{className:`flex items-center justify-between mb-6`,children:[(0,S.jsx)(`h3`,{className:`text-xl font-bold text-white`,children:`User Roles & Permissions`}),(0,S.jsxs)(`button`,{className:`bg-gradient-to-r from-purple-600 to-blue-600 text-white px-4 py-2 rounded-xl font-medium hover:shadow-lg transition-all duration-300`,children:[(0,S.jsx)(v,{className:`inline h-4 w-4 mr-2`}),`Create Role`]})]}),(0,S.jsx)(`div`,{className:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6`,children:m.map(t=>(0,S.jsxs)(`div`,{className:`bg-white/10 rounded-2xl p-6 border border-white/20`,children:[(0,S.jsxs)(`div`,{className:`flex items-center justify-between mb-4`,children:[(0,S.jsx)(`div`,{className:`p-3 rounded-xl bg-gradient-to-r ${t.color} text-white`,children:(0,S.jsx)(o,{className:`h-6 w-6`})}),(0,S.jsx)(`button`,{className:`p-2 text-white/60 hover:text-blue-400 hover:bg-blue-500/10 rounded-xl transition-colors`,children:(0,S.jsx)(r,{className:`h-4 w-4`})})]}),(0,S.jsx)(`h4`,{className:`text-white font-semibold mb-2`,children:t.name}),(0,S.jsx)(`p`,{className:`text-white/70 text-sm mb-4`,children:t.description}),(0,S.jsxs)(`div`,{className:`space-y-2`,children:[(0,S.jsx)(`h5`,{className:`text-white/80 text-sm font-medium`,children:`Permissions`}),(0,S.jsxs)(`div`,{className:`flex flex-wrap gap-2`,children:[t.permissions.slice(0,3).map((e,t)=>(0,S.jsx)(`span`,{className:`px-2 py-1 bg-white/20 text-white/80 text-xs rounded-lg`,children:e},t)),t.permissions.length>3&&(0,S.jsxs)(`span`,{className:`px-2 py-1 bg-white/20 text-white/80 text-xs rounded-lg`,children:[`+`,t.permissions.length-3,` more`]})]})]}),(0,S.jsx)(`div`,{className:`mt-4 pt-4 border-t border-white/20`,children:(0,S.jsxs)(`div`,{className:`flex justify-between text-sm`,children:[(0,S.jsx)(`span`,{className:`text-white/60`,children:`Users with this role`}),(0,S.jsx)(`span`,{className:`text-white font-medium`,children:e.filter(e=>e.role===t.name.toLowerCase().replace(` `,`_`)).length})]})})]},t.id))})]})}))(),D===`audit`&&(()=>(0,S.jsx)(`div`,{className:`space-y-6`,children:(0,S.jsxs)(`div`,{className:`bg-white/20 backdrop-blur-sm rounded-2xl p-6 border border-white/30`,children:[(0,S.jsx)(`h3`,{className:`text-xl font-bold text-white mb-6`,children:`User Activity Audit Trail`}),(0,S.jsx)(`div`,{className:`space-y-4`,children:T.map(e=>(0,S.jsx)(`div`,{className:`bg-white/10 rounded-xl p-4 border border-white/20`,children:(0,S.jsxs)(`div`,{className:`flex items-start justify-between`,children:[(0,S.jsxs)(`div`,{className:`flex items-start space-x-4`,children:[(0,S.jsx)(`div`,{className:`bg-blue-500/20 p-2 rounded-xl`,children:(0,S.jsx)(d,{className:`h-5 w-5 text-blue-400`})}),(0,S.jsxs)(`div`,{className:`flex-1`,children:[(0,S.jsxs)(`div`,{className:`flex items-center space-x-2 mb-2`,children:[(0,S.jsx)(`h4`,{className:`text-white font-semibold`,children:e.action}),(0,S.jsx)(`span`,{className:`px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded-lg`,children:e.resource})]}),(0,S.jsxs)(`div`,{className:`grid grid-cols-1 md:grid-cols-3 gap-4 text-sm`,children:[(0,S.jsxs)(`div`,{children:[(0,S.jsx)(`span`,{className:`text-white/60`,children:`User: `}),(0,S.jsx)(`span`,{className:`text-white`,children:e.userName})]}),(0,S.jsxs)(`div`,{children:[(0,S.jsx)(`span`,{className:`text-white/60`,children:`IP Address: `}),(0,S.jsx)(`span`,{className:`text-white`,children:e.ipAddress})]}),(0,S.jsxs)(`div`,{children:[(0,S.jsx)(`span`,{className:`text-white/60`,children:`Time: `}),(0,S.jsx)(`span`,{className:`text-white`,children:G(e.timestamp)})]})]})]})]}),(0,S.jsx)(`button`,{className:`p-2 text-white/60 hover:text-blue-400 hover:bg-blue-500/10 rounded-xl transition-colors`,children:(0,S.jsx)(n,{className:`h-4 w-4`})})]})},e.id))})]})}))(),D===`settings`&&(0,S.jsxs)(`div`,{className:`bg-white/20 backdrop-blur-sm rounded-2xl p-6 border border-white/30`,children:[(0,S.jsxs)(`div`,{className:`text-center`,children:[(0,S.jsx)(_,{className:`h-16 w-16 text-white/40 mx-auto mb-4`}),(0,S.jsx)(`h3`,{className:`text-xl font-semibold text-white/80 mb-2`,children:`Security Settings`}),(0,S.jsx)(`p`,{className:`text-white/60 mb-4`,children:`Manage two-factor authentication for your account.`})]}),(0,S.jsx)(`div`,{className:`max-w-xl mx-auto mt-6 space-y-4 text-left`,children:(0,S.jsxs)(`div`,{className:`bg-white/10 rounded-2xl p-6 border border-white/20`,children:[(0,S.jsx)(`h4`,{className:`text-white font-semibold mb-2`,children:`Two-Factor Authentication (2FA)`}),(0,S.jsx)(`p`,{className:`text-white/70 text-sm mb-4`,children:`Add an extra layer of security using authenticator apps (e.g., Google Authenticator, Authy).`}),(()=>{let n=L&&typeof L==`object`&&`id`in L?String(L.id):`1`,r=e.find(e=>e.id===n);return r?(0,S.jsxs)(`div`,{className:`space-y-3`,children:[(0,S.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,S.jsx)(`span`,{className:`text-white/80`,children:`2FA Status`}),(0,S.jsx)(`span`,{className:`px-3 py-1 rounded-full text-xs font-medium ${r.twoFactorEnabled?`bg-green-600 text-white`:`bg-red-600 text-white`}`,children:r.twoFactorEnabled?`Enabled`:`Disabled`})]}),r.twoFactorEnabled?(0,S.jsxs)(`div`,{className:`space-y-2`,children:[(0,S.jsx)(`p`,{className:`text-white/70 text-sm`,children:`2FA is currently enabled for your account. You can disable it below.`}),(0,S.jsx)(`button`,{onClick:async()=>{try{await y.disable2FA(),t(e=>e.map(e=>e.id===`1`?{...e,twoFactorEnabled:!1}:e)),alert(`2FA disabled`)}catch(e){console.error(e),alert(`Failed to disable 2FA`)}},className:`bg-red-600 text-white px-4 py-2 rounded-xl`,children:`Disable 2FA`})]}):(0,S.jsxs)(`div`,{className:`space-y-2`,children:[(0,S.jsx)(`button`,{onClick:async()=>{try{let e=await y.setup2FA(),t=e?.data??e,n=typeof t==`object`&&t?t:{};function r(e,t){if(typeof e==`object`&&e&&t in e){let n=e[t];return typeof n==`string`?n:void 0}}let i=r(n,`qr`)??r(n.data,`qr`)??r(n,`otpauth_url`),a=r(n,`secret`)??r(n.data,`secret`);H({qr:i,secret:a}),B(!0)}catch(e){console.error(e),alert(`Failed to start 2FA setup`)}},className:`bg-blue-600 text-white px-4 py-2 rounded-xl`,children:`Setup 2FA`}),(0,S.jsxs)(`div`,{className:`pt-2`,children:[(0,S.jsx)(`label`,{className:`block text-white/80 text-sm mb-1`,children:`Enter code from your authenticator`}),(0,S.jsxs)(`div`,{className:`flex space-x-2`,children:[(0,S.jsx)(`input`,{id:`tfacode`,className:`flex-1 px-3 py-2 rounded-xl bg-white/5 text-white border border-white/20`,placeholder:`123456`}),(0,S.jsx)(`button`,{onClick:async()=>{let e=document.getElementById(`tfacode`)?.value||``;try{let n=await y.verify2FA({token:e}),r=n?.data??n;function i(e){return typeof e==`object`&&!!e&&`backupCodes`in e}let a=i(r)?r.backupCodes:Array.isArray(r)?r:[];W(a),t(e=>e.map(e=>e.id===`1`?{...e,twoFactorEnabled:!0}:e)),B(!0),typeof window<`u`&&typeof window.alert==`function`&&window.alert(`2FA enabled`)}catch(e){console.error(e),alert(`Invalid token or verification failed`)}},className:`bg-green-600 text-white px-4 py-2 rounded-xl`,children:`Verify & Enable`})]})]})]})]}):(0,S.jsx)(`p`,{className:`text-white/60`,children:`User not found`})})()]})})]})]})}),(0,S.jsx)(C,{open:z,onClose:()=>B(!1),qrDataUrl:V?.qr,secret:V?.secret,backupCodes:U}),(0,S.jsx)(`div`,{className:`bg-white/10 backdrop-blur-sm rounded-2xl p-4 border border-white/30 text-center`,children:(0,S.jsxs)(`p`,{className:`text-white/60 text-sm`,children:[`👥 `,e.length,` total users | 🔐 `,e.filter(e=>e.twoFactorEnabled).length,` with 2FA enabled | 📊 `,T.length,` recent activities logged`]})})]})})};export{w as default};
//# sourceMappingURL=UserManagement-CFPSsFaj.js.map