import{r as e}from"./rolldown-runtime-DGruFWvd.js";import{_ as t}from"./charts-CsPrSeQA.js";import{E as n,G as r,I as i,M as a,P as o,Z as s,et as c,n as l,rt as u,tt as d,v as f,y as p}from"./vendor-C1UjBRMx.js";var m=e(t()),h=e(l()),g=()=>{let[e,t]=(0,m.useState)(`authenticator`),[l,g]=(0,m.useState)(`select`),[_,v]=(0,m.useState)(``),[y,b]=(0,m.useState)(``),[x,S]=(0,m.useState)([]),[C,w]=(0,m.useState)(!1),[T,E]=(0,m.useState)(``),[D,O]=(0,m.useState)([]);(0,m.useEffect)(()=>{O([{id:`authenticator`,name:`Authenticator App`,type:`authenticator`,description:`Use Google Authenticator, Authy, or similar apps`,icon:(0,h.jsx)(f,{className:`h-6 w-6`}),enabled:!1,setupRequired:!0},{id:`sms`,name:`SMS Text Message`,type:`sms`,description:`Receive codes via SMS to your phone`,icon:(0,h.jsx)(a,{className:`h-6 w-6`}),enabled:!1,setupRequired:!0},{id:`email`,name:`Email Verification`,type:`email`,description:`Receive codes via email`,icon:(0,h.jsx)(o,{className:`h-6 w-6`}),enabled:!0,lastUsed:new Date(Date.now()-7200*1e3),setupRequired:!1},{id:`backup_codes`,name:`Backup Codes`,type:`backup_codes`,description:`One-time use codes for emergency access`,icon:(0,h.jsx)(i,{className:`h-6 w-6`}),enabled:!1,setupRequired:!0}]),v(`JBSWY3DPEHPK3PXP`),S([{code:`98765432`,used:!1},{code:`87654321`,used:!1},{code:`76543210`,used:!1},{code:`65432109`,used:!1},{code:`54321098`,used:!1},{code:`43210987`,used:!0,usedAt:new Date(Date.now()-1440*60*1e3)},{code:`32109876`,used:!1},{code:`21098765`,used:!1},{code:`10987654`,used:!1},{code:`09876543`,used:!1}])},[]);let k=async(e,t)=>{try{await navigator.clipboard.writeText(e),E(t),setTimeout(()=>E(``),2e3)}catch(e){console.error(`Failed to copy:`,e)}},A=e=>{t(e),g(`setup`)},j=async()=>{y.length===6&&(w(!0),await new Promise(e=>setTimeout(e,2e3)),O(t=>t.map(t=>t.id===e?{...t,enabled:!0,setupRequired:!1,lastUsed:new Date}:t)),w(!1),g(`complete`))},M=()=>{let e=Array.from({length:10},()=>({code:Math.random().toString().slice(2,10),used:!1}));S(e)},N=()=>{let e=x.map(e=>`${e.code}${e.used?` (USED)`:``}`).join(`
`),t=new Blob([`HAFJET Cloud Accounting System Backup Codes\n\n${e}\n\nKeep these codes safe and secure!`],{type:`text/plain`}),n=URL.createObjectURL(t),r=document.createElement(`a`);r.href=n,r.download=`hafjet-bukku-backup-codes.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)},P=e=>{O(t=>t.map(t=>t.id===e?{...t,enabled:!t.enabled}:t))};return(0,h.jsx)(`div`,{className:`min-h-screen bg-gradient-to-br from-blue-900 to-purple-900 p-6`,children:(0,h.jsxs)(`div`,{className:`max-w-6xl mx-auto`,children:[(0,h.jsxs)(`div`,{className:`mb-8`,children:[(0,h.jsx)(`h1`,{className:`text-4xl font-bold text-white mb-2`,children:`🔐 Two-Factor Authentication`}),(0,h.jsx)(`p`,{className:`text-white/80 text-lg`,children:`🛡️ Enhance your account security with additional verification methods`})]}),(0,h.jsx)(`div`,{className:`bg-white/20 backdrop-blur-sm rounded-2xl p-6 border border-white/30 mb-8`,children:(0,h.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,h.jsxs)(`div`,{className:`flex items-center space-x-4`,children:[(0,h.jsx)(`div`,{className:`p-3 bg-green-500/20 rounded-xl`,children:(0,h.jsx)(p,{className:`h-8 w-8 text-green-400`})}),(0,h.jsxs)(`div`,{children:[(0,h.jsx)(`h3`,{className:`text-white font-semibold`,children:`Security Status`}),(0,h.jsxs)(`p`,{className:`text-white/70`,children:[D.filter(e=>e.enabled).length,` of `,D.length,` methods enabled`]})]})]}),(0,h.jsxs)(`div`,{className:`flex items-center space-x-4`,children:[(0,h.jsxs)(`div`,{className:`text-right`,children:[(0,h.jsx)(`p`,{className:`text-white font-semibold`,children:D.some(e=>e.enabled)?`Protected`:`Vulnerable`}),(0,h.jsx)(`p`,{className:`text-white/60 text-sm`,children:`Account Security`})]}),(0,h.jsx)(`div`,{className:`h-3 w-3 rounded-full ${D.filter(e=>e.enabled).length>=2?`bg-green-400`:D.some(e=>e.enabled)?`bg-yellow-400`:`bg-red-400`}`})]})]})}),(0,h.jsxs)(`div`,{className:`bg-white/20 backdrop-blur-sm rounded-2xl p-8 border border-white/30`,children:[l===`select`&&(0,h.jsxs)(`div`,{children:[(0,h.jsx)(`h2`,{className:`text-2xl font-bold text-white mb-6`,children:`Choose Authentication Methods`}),(()=>(0,h.jsx)(`div`,{className:`grid grid-cols-1 md:grid-cols-2 gap-6`,children:D.map(e=>(0,h.jsxs)(`div`,{className:`bg-white/10 rounded-xl p-6 border border-white/20`,children:[(0,h.jsxs)(`div`,{className:`flex items-start justify-between mb-4`,children:[(0,h.jsxs)(`div`,{className:`flex items-center space-x-3`,children:[(0,h.jsx)(`div`,{className:`p-3 bg-blue-500/20 rounded-xl text-blue-400`,children:e.icon}),(0,h.jsxs)(`div`,{children:[(0,h.jsx)(`h3`,{className:`text-white font-semibold`,children:e.name}),(0,h.jsx)(`p`,{className:`text-white/70 text-sm`,children:e.description})]})]}),(0,h.jsx)(`div`,{className:`flex items-center space-x-2`,children:e.enabled?(0,h.jsxs)(`span`,{className:`flex items-center space-x-1 text-green-400 text-sm`,children:[(0,h.jsx)(c,{className:`h-4 w-4`}),(0,h.jsx)(`span`,{children:`Enabled`})]}):(0,h.jsx)(`span`,{className:`text-gray-400 text-sm`,children:`Disabled`})})]}),e.lastUsed&&(0,h.jsxs)(`p`,{className:`text-white/60 text-xs mb-4`,children:[`Last used: `,e.lastUsed.toLocaleString()]}),(0,h.jsxs)(`div`,{className:`flex space-x-3`,children:[e.setupRequired?(0,h.jsx)(`button`,{onClick:()=>A(e.id),className:`bg-blue-600 text-white px-4 py-2 rounded-xl text-sm font-medium hover:bg-blue-700 transition-colors`,children:`Set Up`}):(0,h.jsx)(`button`,{onClick:()=>P(e.id),className:`px-4 py-2 rounded-xl text-sm font-medium transition-colors ${e.enabled?`bg-red-600 text-white hover:bg-red-700`:`bg-green-600 text-white hover:bg-green-700`}`,children:e.enabled?`Disable`:`Enable`}),e.type===`backup_codes`&&(0,h.jsxs)(`button`,{onClick:N,className:`bg-purple-600 text-white px-4 py-2 rounded-xl text-sm font-medium hover:bg-purple-700 transition-colors`,children:[(0,h.jsx)(r,{className:`inline h-4 w-4 mr-1`}),`Download`]})]})]},e.id))}))()]}),l===`setup`&&e===`authenticator`&&(()=>(0,h.jsx)(`div`,{className:`max-w-2xl mx-auto`,children:(0,h.jsxs)(`div`,{className:`bg-white/10 rounded-xl p-8 border border-white/20`,children:[(0,h.jsx)(`h3`,{className:`text-xl font-bold text-white mb-6 text-center`,children:`Set up Authenticator App`}),(0,h.jsxs)(`div`,{className:`space-y-6`,children:[(0,h.jsxs)(`div`,{className:`text-center`,children:[(0,h.jsx)(`div`,{className:`bg-white p-4 rounded-xl inline-block mb-4`,children:(0,h.jsx)(n,{className:`h-32 w-32 text-gray-800`})}),(0,h.jsx)(`p`,{className:`text-white/80 text-sm`,children:`Scan this QR code with your authenticator app`})]}),(0,h.jsxs)(`div`,{className:`space-y-4`,children:[(0,h.jsxs)(`div`,{children:[(0,h.jsx)(`label`,{className:`block text-white/80 text-sm font-medium mb-2`,children:`Or enter this key manually:`}),(0,h.jsxs)(`div`,{className:`flex items-center space-x-2`,children:[(0,h.jsx)(`input`,{type:`text`,value:_,readOnly:!0,className:`flex-1 bg-white/10 border border-white/30 rounded-xl px-4 py-3 text-white focus:outline-none`}),(0,h.jsx)(`button`,{onClick:()=>k(_,`secret`),className:`p-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors`,children:T===`secret`?(0,h.jsx)(u,{className:`h-4 w-4`}):(0,h.jsx)(s,{className:`h-4 w-4`})})]})]}),(0,h.jsxs)(`div`,{children:[(0,h.jsx)(`label`,{className:`block text-white/80 text-sm font-medium mb-2`,children:`Enter verification code:`}),(0,h.jsx)(`input`,{type:`text`,value:y,onChange:e=>b(e.target.value.replace(/\D/g,``).slice(0,6)),placeholder:`000000`,className:`w-full bg-white/10 border border-white/30 rounded-xl px-4 py-3 text-white text-center text-lg tracking-widest focus:outline-none focus:ring-2 focus:ring-blue-500`})]})]}),(0,h.jsxs)(`div`,{className:`flex space-x-4`,children:[(0,h.jsx)(`button`,{onClick:()=>g(`select`),className:`flex-1 bg-gray-600 text-white py-3 rounded-xl font-medium hover:bg-gray-700 transition-colors`,children:`Back`}),(0,h.jsx)(`button`,{onClick:j,disabled:y.length!==6||C,className:`flex-1 bg-green-600 text-white py-3 rounded-xl font-medium hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed`,children:C?(0,h.jsxs)(`div`,{className:`flex items-center justify-center space-x-2`,children:[(0,h.jsx)(`div`,{className:`animate-spin h-4 w-4 border-2 border-white/30 border-t-white rounded-full`}),(0,h.jsx)(`span`,{children:`Verifying...`})]}):`Verify & Enable`})]})]})]})}))(),l===`complete`&&(()=>(0,h.jsx)(`div`,{className:`max-w-md mx-auto text-center`,children:(0,h.jsxs)(`div`,{className:`bg-green-500/20 border border-green-500/30 rounded-xl p-8`,children:[(0,h.jsx)(c,{className:`h-16 w-16 text-green-400 mx-auto mb-4`}),(0,h.jsx)(`h3`,{className:`text-xl font-bold text-white mb-2`,children:`Setup Complete!`}),(0,h.jsx)(`p`,{className:`text-white/80 mb-6`,children:`Two-factor authentication has been enabled for your account.`}),(0,h.jsxs)(`div`,{className:`space-y-4`,children:[(0,h.jsx)(`button`,{onClick:M,className:`w-full bg-blue-600 text-white py-3 rounded-xl font-medium hover:bg-blue-700 transition-colors`,children:`Generate Backup Codes`}),(0,h.jsx)(`button`,{onClick:()=>g(`select`),className:`w-full bg-gray-600 text-white py-3 rounded-xl font-medium hover:bg-gray-700 transition-colors`,children:`Back to Settings`})]})]})}))(),e===`backup_codes`&&l===`select`&&(()=>(0,h.jsx)(`div`,{className:`max-w-2xl mx-auto`,children:(0,h.jsxs)(`div`,{className:`bg-white/10 rounded-xl p-6 border border-white/20`,children:[(0,h.jsxs)(`div`,{className:`flex items-center justify-between mb-6`,children:[(0,h.jsx)(`h3`,{className:`text-xl font-bold text-white`,children:`Backup Codes`}),(0,h.jsxs)(`div`,{className:`flex space-x-3`,children:[(0,h.jsx)(`button`,{onClick:M,className:`bg-yellow-600 text-white px-4 py-2 rounded-xl text-sm font-medium hover:bg-yellow-700 transition-colors`,children:`Generate New`}),(0,h.jsxs)(`button`,{onClick:N,className:`bg-blue-600 text-white px-4 py-2 rounded-xl text-sm font-medium hover:bg-blue-700 transition-colors`,children:[(0,h.jsx)(r,{className:`inline h-4 w-4 mr-1`}),`Download`]})]})]}),(0,h.jsx)(`div`,{className:`bg-yellow-500/10 border border-yellow-500/30 rounded-xl p-4 mb-6`,children:(0,h.jsxs)(`div`,{className:`flex items-start space-x-3`,children:[(0,h.jsx)(d,{className:`h-5 w-5 text-yellow-400 mt-0.5`}),(0,h.jsxs)(`div`,{children:[(0,h.jsx)(`p`,{className:`text-yellow-400 font-medium text-sm`,children:`Important:`}),(0,h.jsx)(`p`,{className:`text-yellow-300 text-sm`,children:`Each backup code can only be used once. Store them securely and don't share them.`})]})]})}),(0,h.jsx)(`div`,{className:`grid grid-cols-2 gap-4`,children:x.map((e,t)=>(0,h.jsxs)(`div`,{className:`p-3 rounded-xl border font-mono text-center ${e.used?`bg-red-500/10 border-red-500/30 text-red-400 line-through`:`bg-green-500/10 border-green-500/30 text-green-400`}`,children:[e.code,e.used&&e.usedAt&&(0,h.jsxs)(`p`,{className:`text-xs text-red-300 mt-1`,children:[`Used `,e.usedAt.toLocaleDateString()]})]},t))}),(0,h.jsx)(`div`,{className:`mt-6 text-center`,children:(0,h.jsxs)(`p`,{className:`text-white/60 text-sm`,children:[x.filter(e=>!e.used).length,` of `,x.length,` codes remaining`]})})]})}))()]}),l===`select`&&(0,h.jsx)(`div`,{className:`mt-8 bg-white/10 backdrop-blur-sm rounded-2xl p-4 border border-white/30 text-center`,children:(0,h.jsx)(`p`,{className:`text-white/60 text-sm`,children:`🔒 Enable at least 2 methods for optimal security | 📱 Authenticator apps are recommended | 💾 Always keep backup codes safe`})})]})})};export{g as default};
//# sourceMappingURL=TwoFactorAuth-BIf6M7NG.js.map